"use strict";!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery||Zepto)}(function(a){var e=function(e,t,n){var r={invalid:[],getCaret:function(){try{var a,t=0,n=e.get(0),o=document.selection,i=n.selectionStart;return o&&navigator.appVersion.indexOf("MSIE 10")===-1?(a=o.createRange(),a.moveStart("character",-r.val().length),t=a.text.length):(i||"0"===i)&&(t=i),t}catch(a){}},setCaret:function(a){try{if(e.is(":focus")){var t,n=e.get(0);n.setSelectionRange?(n.focus(),n.setSelectionRange(a,a)):(t=n.createTextRange(),t.collapse(!0),t.moveEnd("character",a),t.moveStart("character",a),t.select())}}catch(a){}},events:function(){e.on("keydown.mask",function(a){e.data("mask-keycode",a.keyCode||a.which)}).on(a.jMaskGlobals.useInput?"input.mask":"keyup.mask",r.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){e.keydown().keyup()},100)}).on("change.mask",function(){e.data("changed",!0)}).on("blur.mask",function(){s===r.val()||e.data("changed")||e.trigger("change"),e.data("changed",!1)}).on("blur.mask",function(){s=r.val()}).on("focus.mask",function(e){n.selectOnFocus===!0&&a(e.target).select()}).on("focusout.mask",function(){n.clearIfNotMatch&&!o.test(r.val())&&r.val("")})},getRegexMask:function(){for(var a,e,n,r,o,s,l=[],c=0;c<t.length;c++)a=i.translation[t.charAt(c)],a?(e=a.pattern.toString().replace(/.{1}$|^.{1}/g,""),n=a.optional,r=a.recursive,r?(l.push(t.charAt(c)),o={digit:t.charAt(c),pattern:e}):l.push(n||r?e+"?":e)):l.push(t.charAt(c).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return s=l.join(""),o&&(s=s.replace(new RegExp("("+o.digit+"(.*"+o.digit+")?)"),"($1)?").replace(new RegExp(o.digit,"g"),o.pattern)),new RegExp(s)},destroyEvents:function(){e.off(["input","keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(a){var t,n=e.is("input"),r=n?"val":"text";return arguments.length>0?(e[r]()!==a&&e[r](a),t=e):t=e[r](),t},getMCharsBeforeCount:function(a,e){for(var n=0,r=0,o=t.length;r<o&&r<a;r++)i.translation[t.charAt(r)]||(a=e?a+1:a,n++);return n},caretPos:function(a,e,n,o){var s=i.translation[t.charAt(Math.min(a-1,t.length-1))];return s?Math.min(a+n-e-o,n):r.caretPos(a+1,e,n,o)},behaviour:function(t){t=t||window.event,r.invalid=[];var n=e.data("mask-keycode");if(a.inArray(n,i.byPassKeys)===-1){var o=r.getCaret(),s=r.val(),l=s.length,c=r.getMasked(),d=c.length,v=r.getMCharsBeforeCount(d-1)-r.getMCharsBeforeCount(l-1),u=o<l;return r.val(c),u&&(8!==n&&46!==n&&(o=r.caretPos(o,l,d,v)),r.setCaret(o)),r.callbacks(t)}},getMasked:function(a,e){var o,s,l=[],c=void 0===e?r.val():e+"",d=0,v=t.length,u=0,m=c.length,h=1,f="push",p=-1;for(n.reverse?(f="unshift",h=-1,o=0,d=v-1,u=m-1,s=function(){return d>-1&&u>-1}):(o=v-1,s=function(){return d<v&&u<m});s();){var g=t.charAt(d),_=c.charAt(u),k=i.translation[g];k?(_.match(k.pattern)?(l[f](_),k.recursive&&(p===-1?p=d:d===o&&(d=p-h),o===p&&(d-=h)),d+=h):k.optional?(d+=h,u-=h):k.fallback?(l[f](k.fallback),d+=h,u-=h):r.invalid.push({p:u,v:_,e:k.pattern}),u+=h):(a||l[f](g),_===g&&(u+=h),d+=h)}var $=t.charAt(o);return v!==m+1||i.translation[$]||l.push($),l.join("")},callbacks:function(a){var o=r.val(),i=o!==s,l=[o,a,e,n],c=function(a,e,t){"function"==typeof n[a]&&e&&n[a].apply(this,t)};c("onChange",i===!0,l),c("onKeyPress",i===!0,l),c("onComplete",o.length===t.length,l),c("onInvalid",r.invalid.length>0,[o,a,e,r.invalid,n])}};e=a(e);var o,i=this,s=r.val();t="function"==typeof t?t(r.val(),void 0,e,n):t,i.mask=t,i.options=n,i.remove=function(){var a=r.getCaret();return r.destroyEvents(),r.val(i.getCleanVal()),r.setCaret(a-r.getMCharsBeforeCount(a)),e},i.getCleanVal=function(){return r.getMasked(!0)},i.getMaskedVal=function(a){return r.getMasked(!1,a)},i.init=function(t){if(t=t||!1,n=n||{},i.clearIfNotMatch=a.jMaskGlobals.clearIfNotMatch,i.byPassKeys=a.jMaskGlobals.byPassKeys,i.translation=a.extend({},a.jMaskGlobals.translation,n.translation),i=a.extend(!0,{},i,n),o=r.getRegexMask(),t===!1){n.placeholder&&e.attr("placeholder",n.placeholder),e.data("mask")&&e.attr("autocomplete","off"),r.destroyEvents(),r.events();var s=r.getCaret();r.val(r.getMasked()),r.setCaret(s+r.getMCharsBeforeCount(s,!0))}else r.events(),r.val(r.getMasked())},i.init(!e.is("input"))};a.maskWatchers={};var t=function(){var t=a(this),r={},o="data-mask-",i=t.attr("data-mask");if(t.attr(o+"reverse")&&(r.reverse=!0),t.attr(o+"clearifnotmatch")&&(r.clearIfNotMatch=!0),"true"===t.attr(o+"selectonfocus")&&(r.selectOnFocus=!0),n(t,i,r))return t.data("mask",new e(this,i,r))},n=function(e,t,n){n=n||{};var r=a(e).data("mask"),o=JSON.stringify,i=a(e).val()||a(e).text();try{return"function"==typeof t&&(t=t(i)),"object"!=typeof r||o(r.options)!==o(n)||r.mask!==t}catch(a){}},r=function(a){var e,t=document.createElement("div");return a="on"+a,e=a in t,e||(t.setAttribute(a,"return;"),e="function"==typeof t[a]),t=null,e};a.fn.mask=function(t,r){r=r||{};var o=this.selector,i=a.jMaskGlobals,s=i.watchInterval,l=r.watchInputs||i.watchInputs,c=function(){if(n(this,t,r))return a(this).data("mask",new e(this,t,r))};return a(this).each(c),o&&""!==o&&l&&(clearInterval(a.maskWatchers[o]),a.maskWatchers[o]=setInterval(function(){a(document).find(o).each(c)},s)),this},a.fn.masked=function(a){return this.data("mask").getMaskedVal(a)},a.fn.unmask=function(){return clearInterval(a.maskWatchers[this.selector]),delete a.maskWatchers[this.selector],this.each(function(){var e=a(this).data("mask");e&&e.remove().removeData("mask")})},a.fn.cleanVal=function(){return this.data("mask").getCleanVal()},a.applyDataMask=function(e){e=e||a.jMaskGlobals.maskElements;var n=e instanceof a?e:a(e);n.filter(a.jMaskGlobals.dataMaskAttr).each(t)};var o={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,useInput:r("input"),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};a.jMaskGlobals=a.jMaskGlobals||{},o=a.jMaskGlobals=a.extend(!0,{},o,a.jMaskGlobals),o.dataMask&&a.applyDataMask(),setInterval(function(){a.jMaskGlobals.watchDataMask&&a.applyDataMask()},o.watchInterval)}),$(function(){searchZipcode("#cep_entrega","#endereco_entrega","#cidade_entrega","#estado_entrega","#complemento_entrega","#complemento_entrega"),searchZipcode("#cep_solicitante","#endereco_solicitante","#cidade_solicitante","#estado_solicitante","#complemento_solicitante","#complemento_solicitante"),initMasks(),initNewInsuranceFormEvent(),initTaskFormSubmitEvent(),initRequiredValidationFields(),initCheckSameAddressCheckbox(),initTotal()});var initTotal=function(){$("#can-add-insurance tr").each(function(){var a=$(this),e=a.data("index"),t=$("#insumo_quantidade_"+e).val(),n=$("#insumo_valor_"+e).val(),r=Number(t)*Number(n);calcTotal(r)})},calcTotal=function(a){var e=$("#order-total-value input"),t=Number(e.val());a+=t,e.val(a)},searchZipcode=function(a,e,t,n,r,o){$(a).on("blur",function(){var i=$(a);if(i.val().length>=8){var s="https://viacep.com.br/ws/"+i.val()+"/json/";$.get(s,function(a){$(e).val(a.logradouro),$(t).val(a.localidade),$(n).val(a.uf),$(r).val(a.complemento),$(o).focus()})}})},validateRequesterInfo=function(){var a=$("#nome_solicitante"),e=$("#cpf_solicitante"),t=$("#telefone_solicitante"),n=$("#cep_solicitante"),r=$("#endereco_solicitante"),o=$("#cidade_solicitante"),i=$("#estado_solicitante"),s=!1;return validateLength(a.val(),3,50)?(a.removeClass("has-error"),$("#nome_solicitante_invalido").html("")):(a.addClass("has-error"),$("#nome_solicitante_invalido").html("Preencha o campo com no mínimo 3 caracteres e no máximo 50"),s=!0),validateCpf(e.val())?(e.removeClass("has-error"),$("#cpf_solicitante_invalido").html("")):(e.addClass("has-error"),$("#cpf_solicitante_invalido").html("CPF inválido"),s=!0),validateTelephone(t.val())?(t.removeClass("has-error"),$("#telefone_solicitante_invalido").html("")):(t.addClass("has-error"),$("#telefone_solicitante_invalido").html("Telefone inválido"),s=!0),validateZipcode(n.val())?(n.removeClass("has-error"),$("#cep_solicitante_invalido").html("")):(n.addClass("has-error"),$("#cep_solicitante_invalido").html("CEP inválido"),s=!0),validateLength(r.val(),5)?(r.removeClass("has-error"),$("#endereco_solicitante_invalido").html("")):(r.addClass("has-error"),$("#endereco_solicitante_invalido").html("Preencha o campo com no mínimo 5 caracteres"),s=!0),validateLength(o.val(),5)?(o.removeClass("has-error"),$("#cidade_solicitante_invalido").html("")):(o.addClass("has-error"),$("#cidade_solicitante_invalido").html("Preencha o campo com no mínimo 5 caracteres"),s=!0),validateUf(i.val())?(i.removeClass("has-error"),$("#estado_solicitante_invalido").html("")):(i.addClass("has-error"),$("#estado_solicitante_invalido").html("Selecione uma UF válida"),s=!0),s},validateShippingAddressInfo=function(){var a=$("#cep_entrega"),e=$("#endereco_entrega"),t=$("#cidade_entrega"),n=$("#estado_entrega"),r=!1;return validateZipcode(a.val())?(a.removeClass("has-error"),$("#cep_entrega_invalido").html("")):(a.addClass("has-error"),$("#cep_entrega_invalido").html("CEP inválido"),r=!0),validateLength(e.val(),5)?(e.removeClass("has-error"),$("#endereco_entrega_invalido").html("")):(e.addClass("has-error"),$("#endereco_entrega_invalido").html("Preencha o campo com no mínimo 5 caracteres"),r=!0),validateLength(t.val(),5)?(t.removeClass("has-error"),$("#cidade_entrega_invalido").html("")):(t.addClass("has-error"),$("#cidade_entrega_invalido").html("Preencha o campo com no mínimo 5 caracteres"),r=!0),validateUf(n.val())?(n.removeClass("has-error"),$("#estado_entrega_invalido").html("")):(n.addClass("has-error"),$("#estado_entrega_invalido").html("Selecione uma UF válida"),r=!0),r},validateOrderInfo=function(){return!0},initCheckSameAddressCheckbox=function(){$("#check_same_address").on("click",function(){var a=$("#can-disable-by-checkbox");a.hasClass("disabled")?(a.removeClass("disabled"),$("#cep_entrega, #endereco_entrega, #cidade_entrega, #estado_entrega, #complemento_entrega").removeAttr("disabled")):(a.addClass("disabled"),$("#cep_entrega, #endereco_entrega, #cidade_entrega, #estado_entrega, #complemento_entrega").attr("disabled","disabled"))})},initTaskFormSubmitEvent=function(){$("#task-form").on("submit",function(a){a.preventDefault(),$(".required").each(function(a,e){var t=$(this).attr("id");$(this).attr("disabled")||""!=$(this).val()?($(this).removeClass("has-error"),$("#"+t+"_invalido").html("")):($(this).addClass("has-error"),$("#"+t+"_invalido").html("Campo Obrigatório"))});var e=!0;validateRequesterInfo()||(e=!0),validateShippingAddressInfo()||(e=!0),validateOrderInfo()||(e=!0),e||$(".required").each(function(a,e){var t=$(this).attr("id");$(this).removeClass("has-error"),$("#"+t+"_invalido").html("")})})},initRequiredValidationFields=function(){$(".required").on("blur",function(){var a=$(this);""==a.val()?a.addClass("has-error"):a.removeClass("has-error")})},initMasks=function(){$("#cep_entrega, #cep_solicitante").mask("00000-000",{clearIfNotMatch:!0}),$("#cpf_solicitante").mask("000.000.000-00",{clearIfNotMatch:!0}),$("#telefone_solicitante").mask("(00) 0000-00009",{clearIfNotMatch:!0})},initNewInsuranceFormEvent=function(){$("#add-new-insurance").on("click",function(a){var e=$("#marca_insumo"),t=$("#preco_insumo"),n=$("#quantidade_insumo"),r=$("#descricao_insumo"),o=!1;if(validateLength(e.val(),2,50)||(e.addClass("has-error"),$("#marca_insumo_invalido").html("Preencha o campo com no mínimo 2 caracteres e no máximo 50"),o=!0),validateNumber(t.val())||(t.addClass("has-error"),$("#preco_insumo_invalido").html("Número inválido"),o=!0),validateInt(n.val())||(n.addClass("has-error"),$("#quantidade_insumo_invalido").html("Número inválido"),o=!0),validateLength(r.val(),3,255)||(r.addClass("has-error"),$("#descricao_insumo_invalido").html("Preencha o campo com no mínimo 3 caracteres e no máximo 255"),o=!0),!o){var i="",s=$("#can-add-insurance tr:last-child").data("index")+1;i+=createElement("td",e.val()+createHiddenInput("insumo["+s+"][marca]",e.val())),i+=createElement("td",r.val()+createHiddenInput("insumo["+s+"][descricao]",r.val())),i+=createElement("td",n.val()+createHiddenInput("insumo["+s+"][quantidade]",n.val(),"id='insumo_quantidade_"+s+"'")),i+=createElement("td",t.val()+createHiddenInput("insumo["+s+"][preco]",t.val(),"id='insumo_preco_'"+s+"'"));var l="<tr data-index='"+s+"'>"+i+"</tr>";$("#can-add-insurance").append(l),$("#new-insurance-modal .close").click();var c=Number(n.val())*Number(t.val());return calcTotal(c),e.val(""),t.val(""),n.val(""),r.val(""),!0}return!1})};